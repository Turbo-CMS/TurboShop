var encodeURL,show_animation,hide_animation,apply,apply_none,apply_img,apply_any,apply_video,apply_link,apply_file_rename,apply_file_duplicate,apply_folder_rename;!function(e,a,t){"use strict";var r,i=null,n=0,o=(r=0,function(e,a){clearTimeout(r),r=setTimeout(e,a)}),l=function(e){if(1==jQuery("#ftp").val())var a=jQuery("#ftp_base_url").val()+jQuery("#upload_dir").val()+jQuery("#fldr_value").val();else a=jQuery("#base_url").val()+jQuery("#cur_dir").val();var t=e.find("a.link").attr("data-file");return""!=t&&null!=t&&(a+=t),""!=(t=e.find("h4 a.folder-link").attr("data-file"))&&null!=t&&(a+=t),a},u={contextActions:{copy_url:function(e){var a=l(e);bootbox.alert('URL:<br/><div class="input-group"><input id="url_text" class="form-control" type="text" value="'+encodeURL(a)+'" /><button id="copy-button" class="btn btn-primary copy-button" data-clipboard-target="#url_text" title="copy"><svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg> '+jQuery("#lang_copy").val()+"</button></div>")},unzip:function(a){var t=jQuery("#sub_folder").val()+jQuery("#fldr_value").val()+a.find("a.link").attr("data-file");show_animation(),e.ajax({type:"POST",url:"ajax_calls.php?action=extract",data:{path:t}}).done((function(e){hide_animation(),""!=e?bootbox.alert(e):window.location.href=jQuery("#refresh").attr("href")+"&"+(new Date).getTime()}))},duplicate:function(e){var a=e.find("h4").text().trim();bootbox.prompt(jQuery("#lang_duplicate").val(),jQuery("#cancel").val(),jQuery("#ok").val(),(function(t){null!==t&&(t=h(t))!=a&&Q("duplicate_file",e.attr("data-path"),t,e,"apply_file_duplicate")}),a+" - copy")},select:function(e){var a,t=l(e),r=jQuery("#field_id").val();1==jQuery("#return_relative_url").val()&&(t=(t=t.replace(jQuery("#base_url").val(),"")).replace(jQuery("#cur_dir").val(),"")),a=1==jQuery("#popup").val()?window.opener:window.parent,""!=r?1==jQuery("#crossdomain").val()?a.postMessage({sender:"responsivefilemanager",url:t,field_id:r},"*"):(jQuery("#"+r,a.document).val(t).trigger("change"),"function"==typeof a.responsive_filemanager_callback&&a.responsive_filemanager_callback(r),j()):apply_any(t)},copy:function(e){s(e,"copy")},cut:function(e){s(e,"cut")},paste:function(){d()},chmod:function(a){var t,r,i,n,o;t=a,jQuery("#files_permission_start").parent().parent().remove(),r=t.find(".rename-file-paths"),i=t.closest("figure").attr("data-path"),n=r.attr("data-permissions"),o=r.attr("data-folder"),e.ajax({type:"POST",url:"ajax_calls.php?action=chmod",data:{path:i,permissions:n,folder:o}}).done((function(a){bootbox.dialog(a,[{label:jQuery("#cancel").val(),class:"btn"},{label:jQuery("#ok").val(),class:"btn-primary",callback:function(){var a="-";jQuery("#u_4").is(":checked")?a+="r":a+="-",jQuery("#u_2").is(":checked")?a+="w":a+="-",jQuery("#u_1").is(":checked")?a+="x":a+="-",jQuery("#g_4").is(":checked")?a+="r":a+="-",jQuery("#g_2").is(":checked")?a+="w":a+="-",jQuery("#g_1").is(":checked")?a+="x":a+="-",jQuery("#a_4").is(":checked")?a+="r":a+="-",jQuery("#a_2").is(":checked")?a+="w":a+="-",jQuery("#a_1").is(":checked")?a+="x":a+="-";var t=jQuery("#chmod_form #chmod_value").val();if(""!=t&&void 0!==t){var n=jQuery("#chmod_form input[name=apply_recursive]:checked").val();""!=n&&void 0!==n||(n="none"),e.ajax({type:"POST",url:"execute.php?action=chmod",data:{path:i,new_mode:t,is_recursive:n,folder:o}}).done((function(e){""!=e?bootbox.alert(e):r.attr("data-permissions",a)}))}}}],{header:jQuery("#lang_file_permission").val()}),setTimeout((function(){c(!1)}),100)}))},edit_text_file:function(a){var t,r;t=a,jQuery("#textfile_edit_area").parent().parent().remove(),r=t.closest("figure").attr("data-path"),e.ajax({type:"POST",url:"ajax_calls.php?action=get_file&sub_action=edit&preview_mode=text",data:{path:r}}).done((function(a){bootbox.dialog(a,[{label:jQuery("#cancel").val(),class:"btn"},{label:jQuery("#ok").val(),class:"btn-primary",callback:function(){var a=jQuery("#textfile_edit_area").val();window.editor&&"function"==typeof window.editor.getData&&(a=window.editor.getData()),e.ajax({type:"POST",url:"execute.php?action=save_text_file",data:{path:r,new_content:a}}).done((function(e){""!=e&&bootbox.alert(e)}))}}],{header:t.find(".name_download").val()})}))}},makeContextMenu:function(){var a=this;e.contextMenu({selector:"figure:not(.back-directory), .list-view2 figure:not(.back-directory)",autoHide:!0,build:function(e){e.addClass("selected");var t={callback:function(t,r){a.contextActions[t](e)},items:{}};return t.items.copy_url={name:jQuery("#lang_show_url").val(),icon:"url",disabled:!1},(e.find(".img-precontainer-mini .filetype").hasClass("zip")||e.find(".img-precontainer-mini .filetype").hasClass("tar")||e.find(".img-precontainer-mini .filetype").hasClass("gz"))&&1==jQuery("#extract_files").val()&&(t.items.unzip={name:jQuery("#lang_extract").val(),icon:"extract",disabled:!1}),e.find(".img-precontainer-mini .filetype").hasClass("edit-text-file-allowed")&&(t.items.edit_text_file={name:jQuery("#lang_edit_file").val(),icon:"edit",disabled:!1}),e.hasClass("directory")||1!=jQuery("#duplicate").val()||(t.items.duplicate={name:jQuery("#lang_duplicate").val(),icon:"duplicate",disabled:!1}),e.hasClass("directory")||1!=jQuery("#copy_cut_files_allowed").val()?e.hasClass("directory")&&1==jQuery("#copy_cut_dirs_allowed").val()&&(t.items.copy={name:jQuery("#lang_copy").val(),icon:"copy",disabled:!1},t.items.cut={name:jQuery("#lang_cut").val(),icon:"cut",disabled:!1}):(t.items.copy={name:jQuery("#lang_copy").val(),icon:"copy",disabled:!1},t.items.cut={name:jQuery("#lang_cut").val(),icon:"cut",disabled:!1}),0==jQuery("#clipboard").val()||e.hasClass("directory")||(t.items.paste={name:jQuery("#lang_paste_here").val(),icon:"clipboard-apply",disabled:!1}),e.hasClass("directory")||1!=jQuery("#chmod_files_allowed").val()?e.hasClass("directory")&&1==jQuery("#chmod_dirs_allowed").val()&&(t.items.chmod={name:jQuery("#lang_file_permission").val(),icon:"key",disabled:!1}):t.items.chmod={name:jQuery("#lang_file_permission").val(),icon:"key",disabled:!1},t.items.sep="----",t.items.info={type:"html",html:"<strong>"+jQuery("#lang_file_info").val()+"</strong>"},t.items.name={name:e.attr("data-name"),icon:"label",disabled:!0},"img"==e.attr("data-type")&&(t.items.dimension={name:e.find(".img-dimension").html(),icon:"dimension",disabled:!0}),"true"!==jQuery("#show_folder_size").val()&&"true"!==jQuery("#show_folder_size").val()||(e.hasClass("directory")?t.items.size={name:e.find(".file-size").html()+" - "+e.find(".nfiles").val()+" "+jQuery("#lang_files").val()+" - "+e.find(".nfolders").val()+" "+jQuery("#lang_folders").val(),icon:"size",disabled:!0}:t.items.size={name:e.find(".file-size").html(),icon:"size",disabled:!0}),t.items.date={name:e.find(".file-date").html(),icon:"date",disabled:!0},t},events:{hide:function(){jQuery("figure").removeClass("selected")}}}),jQuery(document).on("contextmenu",(function(e){if(!jQuery(e.target).is("figure"))return!1}))},updateMultipleSelectionButtons:function(){0<n?jQuery("#multiple-selection").show(300):jQuery("#multiple-selection").hide(300)},bindGridEvents:function(){var a=jQuery("ul.grid");function t(e){var a=e.attr("data-function");"apply_multiple"==a?(e.find(".selection:visible").trigger("click"),e.find(".selector:visible").trigger("click")):window[a](e.attr("data-file"),jQuery("#field_id").val(),e)}a.on("click",".modalAV",(function(a){var t=jQuery(this);a.preventDefault();var r=jQuery("#previewAV"),i=jQuery(".body-preview");r.removeData("modal"),r.modal({backdrop:"static",keyboard:!1}),t.hasClass("audio")?i.css("height","80px"):i.css("height","345px"),e.ajax({url:t.attr("data-url"),success:function(e){i.html(e)}})})),a.on("click",".file-preview-btn",(function(a){var t=jQuery(this);a.preventDefault(),e.ajax({url:t.attr("data-url"),success:function(e){bootbox.modal(e," "+t.parent().parent().parent().find(".name").val())}})})),a.on("click",".preview",(function(){var e=jQuery(this);return 0==e.hasClass("disabled")&&jQuery("#full-img").attr("src",decodeURIComponent(e.attr("data-url"))),!0})),a.on("click",".rename-file",(function(){var a=jQuery(this).closest("figure"),t=a.attr("data-path"),r=a.find("h4"),i=e.trim(r.text());bootbox.prompt(jQuery("#rename").val(),jQuery("#cancel").val(),jQuery("#ok").val(),(function(e){null!==e&&(e=h(e))!=i&&Q("rename_file",t,e,a,"apply_file_rename")}),i)})),a.on("click",".rename-folder",(function(){var a=jQuery(this).closest("figure"),t=a.attr("data-path"),r=a.find("h4"),i=e.trim(r.text());bootbox.prompt(jQuery("#rename").val(),jQuery("#cancel").val(),jQuery("#ok").val(),(function(e){null!==e&&(e=h(e).replace(".",""))!=i&&Q("rename_folder",t,e,a,"apply_folder_rename")}),i)})),a.on("click",".delete-file",(function(){var e=jQuery(this),a=e.closest("figure").attr("data-path");bootbox.confirm(e.attr("data-confirm"),jQuery("#cancel").val(),jQuery("#ok").val(),(function(t){if(1==t){Q("delete_file",a,"","","");var r=jQuery("#files_number");r.text(parseInt(r.text())-1),e.parent().parent().parent().parent().remove()}}))})),a.on("click",".delete-folder",(function(){var e=jQuery(this),a=e.closest("figure").attr("data-path");bootbox.confirm(e.attr("data-confirm"),jQuery("#cancel").val(),jQuery("#ok").val(),(function(t){if(1==t){Q("delete_folder",a,"","","");var r=jQuery("#folders_number");r.text(parseInt(r.text())-1),e.parent().parent().parent().remove()}}))})),jQuery("ul.grid").on("click",".link",(function(e){e.stopPropagation(),t(jQuery(this))})),jQuery("ul.grid").on("click","div.box",(function(e){var a=jQuery(this).find(".link");if(0!==a.length)t(a);else{var r=jQuery(this).find(".folder-link");0!==r.length&&(document.location=jQuery(r).prop("href"))}}))},makeFilters:function(a){jQuery("#filter-input").on("keyup",(function(){n=0,e(".selection:checkbox").removeAttr("checked"),u.updateMultipleSelectionButtons(),jQuery(".filters label").removeClass("btn-primary"),jQuery(".filters label").find("i").removeClass("icon-white"),jQuery("#ff-item-type-all").addClass("btn-primary"),jQuery("#ff-item-type-all").find("i").addClass("icon-white");var t=h(jQuery(this).val()).toLowerCase();jQuery(this).val(t),a&&o((function(){jQuery("li","ul.grid ").each((function(){var e=jQuery(this);""!=t&&-1==e.attr("data-name").toLowerCase().indexOf(t)?e.hide(100):e.show(100)})),e.ajax({url:"ajax_calls.php?action=filter&type="+t}).done((function(e){""!=e&&bootbox.alert(e)})),o((function(){g(0!=jQuery("#descending").val(),"."+jQuery("#sort_by").val()),_()}),500)}),300)})).keypress((function(e){13==e.which&&jQuery("#filter").trigger("click")})),jQuery("#filter").on("click",(function(){var e=h(jQuery("#filter-input").val()),a=jQuery("#current_url").val();0<=a.indexOf("?")?a+="&":a+="?",window.location.href=a+"filter="+e}))},makeUploader:function(){jQuery("#fileupload").fileupload({url:"upload.php",maxChunkSize:2097152}),jQuery("#fileupload").bind("fileuploaddrop",(function(e,a){jQuery(".uploader").show(200),setTimeout((function(){jQuery("#fileupload > div > div.fileupload-buttonbar > div.text-center > button").click()}),200)})),jQuery("#fileupload").bind("fileuploadsubmit",(function(e,a){a.formData={fldr:jQuery("#sub_folder").val()+jQuery("#fldr_value").val()+(a.files[0].relativePath||a.files[0].webkitRelativePath||"")}})),jQuery("#fileupload").addClass("fileupload-processing"),e.ajax({url:jQuery("#fileupload").fileupload("option","url"),dataType:"json",context:jQuery("#fileupload")[0]}).always((function(){jQuery(this).removeClass("fileupload-processing")})),jQuery(".upload-btn").on("click",(function(){jQuery(".uploader").modal("show")})),jQuery(".close-uploader").on("click",(function(){jQuery(".uploader").modal("hide"),setTimeout((function(){window.location.href=jQuery("#refresh").attr("href")+"&"+(new Date).getTime()}),420)}))},makeSort:function(a){jQuery("input[name=radio-sort]").on("click",(function(){var r=jQuery(this).attr("data-item"),i=jQuery("#"+r),o=jQuery(".filters label");n=0,e(".selection:checkbox").removeAttr("checked"),u.updateMultipleSelectionButtons(),o.removeClass("btn-primary"),o.find("i").removeClass("icon-white"),jQuery("#filter-input").val(""),i.addClass("btn-primary"),i.find("i").addClass("icon-white"),"ff-item-type-all"==r?(a?jQuery(".grid li").show(300):window.location.href=jQuery("#current_url").val()+"&sort_by="+jQuery("#sort_by").val()+"&descending="+(t?1:0),"undefined"!=typeof Storage&&localStorage.setItem("sort","")):jQuery(this).is(":checked")&&(jQuery(".grid li").not("."+r).hide(300),jQuery(".grid li."+r).show(300),"undefined"!=typeof Storage&&localStorage.setItem("sort",r)),_()}));var t=jQuery("#descending").val();jQuery(".sorter").on("click",(function(){var r=jQuery(this);t=jQuery("#sort_by").val()!==r.attr("data-sort")||0==t,a?(e.ajax({url:"ajax_calls.php?action=sort&sort_by="+r.attr("data-sort")+"&descending="+(t?1:0)}),g(t,"."+r.attr("data-sort")),jQuery(" a.sorter").removeClass("descending").removeClass("ascending"),t?jQuery(".sort-"+r.attr("data-sort")).addClass("descending"):jQuery(".sort-"+r.attr("data-sort")).addClass("ascending"),jQuery("#sort_by").val(r.attr("data-sort")),jQuery("#descending").val(t?1:0),_()):window.location.href=jQuery("#current_url").val()+"&sort_by="+r.attr("data-sort")+"&descending="+(t?1:0)}))}};function c(a){var t=[];if(t.user=0,t.group=0,void(t.all=0)!==a&&1==a){var r=jQuery("#chmod_form #chmod_value").val();t.user=r.substr(0,1),t.group=r.substr(1,1),t.all=r.substr(2,1),e.each(t,(function(a){(""==t[a]||0==e.isNumeric(t[a])||0>parseInt(t[a])||7<parseInt(t[a]))&&(t[a]="0")})),jQuery("#chmod_form input:checkbox").each((function(){var a,r,i,n=jQuery(this).attr("data-group"),o=jQuery(this).attr("data-value");a=t[n],r=o,(i=[])[1]=[1,3,5,7],i[2]=[2,3,6,7],i[4]=[4,5,6,7],a=parseInt(a),r=parseInt(r),-1!=e.inArray(a,i[r])?jQuery(this).prop("checked",!0):jQuery(this).prop("checked",!1)}))}else jQuery("#chmod_form input:checkbox:checked").each((function(){var e=jQuery(this).attr("data-group"),a=jQuery(this).attr("data-value");t[e]=parseInt(t[e])+parseInt(a)})),jQuery("#chmod_form #chmod_value").val(t.user.toString()+t.group.toString()+t.all.toString())}function s(a,t){var r;"copy"!=t&&"cut"!=t||(r=a.closest("figure").attr("data-path"),e.ajax({type:"POST",url:"ajax_calls.php?action=copy_cut",data:{path:r,sub_action:t}}).done((function(e){""!=e?bootbox.alert(e):(jQuery("#clipboard").val("1"),f(!0))})))}function d(a){bootbox.confirm(jQuery("#lang_paste_confirm").val(),jQuery("#cancel").val(),jQuery("#ok").val(),(function(t){var r;1==t&&(r=void 0!==a?a.closest("figure").attr("data-path"):jQuery("#sub_folder").val()+jQuery("#fldr_value").val(),e.ajax({type:"POST",url:"execute.php?action=paste_clipboard",data:{path:r}}).done((function(e){""!=e?bootbox.alert(e):(jQuery("#clipboard").val("0"),f(!1),setTimeout((function(){window.location.href=jQuery("#refresh").attr("href")+"&"+(new Date).getTime()}),300))})))}))}function f(e){1==e?jQuery(".paste-here-btn, .clear-clipboard-btn").removeClass("disabled"):jQuery(".paste-here-btn, .clear-clipboard-btn").addClass("disabled")}function p(e){var t=jQuery(".grid").width()+e,r=jQuery("#view"),i=jQuery("#help");if(0<r.val()){if(1==r.val())jQuery("ul.grid li, ul.grid figure").css("width","100%");else{var n=Math.floor(t/380);0==n&&(n=1,jQuery("h4").css("font-size",12)),t=Math.floor(t/n-10),jQuery("ul.grid li, ul.grid figure").css("width",t)}i.hide()}else a.touch&&i.show()}function y(){var e=jQuery(this);0==jQuery("#view").val()&&(1==e.attr("toggle")?(e.attr("toggle",0),e.animate({top:"0px"},{queue:!1,duration:300})):(e.attr("toggle",1),e.animate({top:"-30px"},{queue:!1,duration:300})))}function v(e){var a=jQuery("#cur_dir").val();a=a.replace("\\","/");var t=jQuery("#sub_folder").val();t=t.replace("\\","/");var r=jQuery("#base_url").val(),i=jQuery("#fldr_value").val();i=i.replace("\\","/");for(var n=[],o=jQuery("#return_relative_url").val(),l=1==jQuery("#ftp").val(),u=0;u<e.length;u++){var c=e[u];l?n.push(encodeURL(jQuery("#ftp_base_url").val()+jQuery("#upload_dir").val()+i+c)):n.push(encodeURL((1==o?t+i:r+a)+c))}return n}function m(){return 1==jQuery("#popup").val()?window.opener:window.parent}function j(){1==jQuery("#popup").val()?window.close():("function"==typeof parent.jQuery(".modal:has(iframe)").modal&&parent.jQuery(".modal:has(iframe)").modal("hide"),void 0!==parent.jQuery&&parent.jQuery?"object"==typeof parent.jQuery.fancybox?parent.jQuery.fancybox.getInstance().close():"function"==typeof parent.jQuery.fancybox&&parent.jQuery.fancybox.close():"function"==typeof parent.$.fancybox&&parent.$.fancybox.close())}function h(a){return null!=a?("true"==jQuery("#transliteration").val()&&(a=(a=function(e){for(var a=[/[\300-\306]/g,/[\340-\346]/g,/[\310-\313]/g,/[\350-\353]/g,/[\314-\317]/g,/[\354-\357]/g,/[\322-\330]/g,/[\362-\370]/g,/[\331-\334]/g,/[\371-\374]/g,/[\321]/g,/[\361]/g,/[\307]/g,/[\347]/g],t=["A","a","E","e","I","i","O","o","U","u","N","n","C","c"],r=0;r<a.length;r++)e=e.replace(a[r],t[r]);return e}(a)).replace(/[^A-Za-z0-9\.\-\[\] _]+/g,"")),"true"==jQuery("#convert_spaces").val()&&(a=a.replace(/ /g,jQuery("#replace_with").val())),"true"==jQuery("#lower_case").val()&&(a=a.toLowerCase()),a=(a=(a=(a=(a=a.replace('"',"")).replace("'","")).replace("/","")).replace("\\","")).replace(/<\/?[^>]+(>|$)/g,""),e.trim(a)):null}function Q(a,t,r,i,n){null!==r&&(r=h(r),e.ajax({type:"POST",url:"execute.php?action="+a,data:{path:t,name:r.replace("/","")}}).done((function(e){return""!=e?(bootbox.alert(e),!1):(""!=n&&window[n](i,r),!0)})))}function g(a,t){var r=jQuery("li.dir","ul.grid").filter(":visible"),i=jQuery("li.file","ul.grid").filter(":visible");n=0,e(".selection:checkbox").removeAttr("checked"),u.updateMultipleSelectionButtons();var o=[],l=[],c=[],s=[];r.each((function(){var a=jQuery(this),r=a.find(t).val();if(e.isNumeric(r))for(r=parseFloat(r);void 0!==o[r]&&o[r];)r=parseFloat(parseFloat(r)+parseFloat(.001));else r=r+"a"+a.find("a[data-file]").data("file");o[r]=a.html(),l.push(r)})),i.each((function(){var a=jQuery(this),r=a.find(t).val();if(e.isNumeric(r))for(r=parseFloat(r);void 0!==c[r]&&c[r];)r=parseFloat(parseFloat(r)+parseFloat(.001));else r=r+"a"+a.find("a[data-file]").data("file");c[r]=a.html(),s.push(r)})),e.isNumeric(l[0])?l.sort((function(e,a){return parseFloat(e)-parseFloat(a)})):l.sort(),e.isNumeric(s[0])?s.sort((function(e,a){return parseFloat(e)-parseFloat(a)})):s.sort(),a&&(l.reverse(),s.reverse()),r.each((function(e){jQuery(this).html(o[l[e]])})),i.each((function(e){jQuery(this).html(c[s[e]]),jQuery(this).attr("data-name",jQuery(this).children().attr("data-name"))}))}function _(){i.update()}jQuery(document).ready((function(){if(u.makeContextMenu(),"undefined"!=typeof Storage&&1!=jQuery("#type_param").val()&&3!=jQuery("#type_param").val()){var t=localStorage.getItem("sort");if(t){var r=jQuery("#"+t);r.addClass("btn-primary"),r.find("i").addClass("icon-white"),jQuery(".grid li").not("."+t).hide(300),jQuery(".grid li."+t).show(300)}}if(jQuery(".ff-container").on("change",".selection",(function(e){e.stopPropagation(),jQuery(this).is(":checked")?n++:n--,u.updateMultipleSelectionButtons()})),jQuery("#full-img").on("click",(function(){jQuery("#previewLightbox").lightbox("hide")})),jQuery("body").on("click",(function(){jQuery(".tip-right").tooltip("hide")})),u.bindGridEvents(),parseInt(jQuery("#file_number").val())>parseInt(jQuery("#file_number_limit_js").val()))var o=!1;else o=!0;u.makeSort(o),u.makeFilters(o),jQuery("#change_lang_btn").on("click",(function(){e.ajax({type:"POST",url:"ajax_calls.php?action=get_lang",data:{}}).done((function(a){bootbox.dialog(a,[{label:jQuery("#cancel").val(),class:"btn"},{label:jQuery("#ok").val(),class:"btn-primary",callback:function(){var a=jQuery("#new_lang_select").val();e.ajax({type:"POST",url:"ajax_calls.php?action=change_lang",data:{choosen_lang:a}}).done((function(e){""!=e?bootbox.alert(e):setTimeout((function(){window.location.href=jQuery("#refresh").attr("href").replace(/lang=[\w]*&/i,"lang="+a+"&")+"&"+(new Date).getTime()}),100)}))}}],{header:jQuery("#lang_lang_change").val()})}))})),u.makeUploader(),jQuery("body").on("keypress",(function(e){var a=String.fromCharCode(e.which);if("'"==a||'"'==a||"\\"==a||"/"==a)return!1})),jQuery("ul.grid li figcaption").on("click",'a[data-toggle="lightbox"]',(function(){var e,a;e=decodeURIComponent(jQuery(this).attr("data-url")),show_animation(),(a=new Image).src=e,jQuery(a).on("load",(function(){hide_animation()}))})),jQuery(".create-file-btn").on("click",(function(){jQuery("#textfile_create_area").parent().parent().remove(),e.ajax({type:"GET",url:"ajax_calls.php?action=new_file_form"}).done((function(a){bootbox.dialog(a,[{label:jQuery("#cancel").val(),class:"btn"},{label:jQuery("#ok").val(),class:"btn-primary",callback:function(){var a=jQuery("#create_text_file_name").val()+jQuery("#create_text_file_extension").val(),t=jQuery("#textfile_create_area").val();if(null!==a){a=h(a);var r=jQuery("#sub_folder").val()+jQuery("#fldr_value").val();e.ajax({type:"POST",url:"execute.php?action=create_file",data:{path:r,name:a,new_content:t}}).done((function(e){""!=e&&bootbox.alert(e,(function(){setTimeout((function(){window.location.href=jQuery("#refresh").attr("href")+"&"+(new Date).getTime()}),500)}))}))}}}],{header:jQuery("#lang_new_file").val()})}))})),jQuery(".new-folder").on("click",(function(){bootbox.prompt(jQuery("#insert_folder_name").val(),jQuery("#cancel").val(),jQuery("#ok").val(),(function(a){if(null!==a){a=h(a).replace(".","");var t=jQuery("#sub_folder").val()+jQuery("#fldr_value").val();e.ajax({type:"POST",url:"execute.php?action=create_folder",data:{path:t,name:a}}).done((function(e){e?bootbox.alert(jQuery("#rename_existing_folder").val()):setTimeout((function(){window.location.href=jQuery("#refresh").attr("href")+"&"+(new Date).getTime()}),300)}))}}))})),jQuery(".view-controller button").on("click",(function(){var a=jQuery(this);jQuery(".view-controller button").removeClass("active"),jQuery(".view-controller i").removeClass("icon-white"),a.addClass("active"),a.find("i").addClass("icon-white"),e.ajax({url:"ajax_calls.php?action=view&type="+a.attr("data-value")}).done((function(e){""!=e&&bootbox.alert(e)})),void 0!==jQuery("ul.grid")[0]&&jQuery("ul.grid")[0]&&(jQuery("ul.grid")[0].className=jQuery("ul.grid")[0].className.replace(/\blist-view.*?\b/g,"")),void 0!==jQuery(".sorter-container")[0]&&jQuery(".sorter-container")[0]&&(jQuery(".sorter-container")[0].className=jQuery(".sorter-container")[0].className.replace(/\blist-view.*?\b/g,""));var t=a.attr("data-value");jQuery("#view").val(t),jQuery("ul.grid").addClass("list-view"+t),jQuery(".sorter-container").addClass("list-view"+t),1<=a.attr("data-value")?p(0):(jQuery("ul.grid li").css("width",125),jQuery("ul.grid figure").css("width",122)),_()})),a.touch?(jQuery("#help").show(),jQuery(".box:not(.no-effect)").swipe({swipeLeft:y,swipeRight:y,threshold:30})):(jQuery(".tip").tooltip({placement:"bottom"}),jQuery(".tip-top").tooltip({placement:"top"}),jQuery(".tip-left").tooltip({placement:"left"}),jQuery(".tip-right").tooltip({placement:"right"}),jQuery("body").addClass("no-touch")),jQuery(".paste-here-btn").on("click",(function(){0==jQuery(this).hasClass("disabled")&&d()})),jQuery(".clear-clipboard-btn").on("click",(function(){0==jQuery(this).hasClass("disabled")&&bootbox.confirm(jQuery("#lang_clear_clipboard_confirm").val(),jQuery("#cancel").val(),jQuery("#ok").val(),(function(a){1==a&&e.ajax({type:"POST",url:"ajax_calls.php?action=reset_clipboard",data:{}}).done((function(e){""!=e?bootbox.alert(e):jQuery("#clipboard").val("0"),f(!1)}))}))}));var l=function(e){var a=[];return jQuery(".selection:checkbox:checked:visible").each((function(){var t=jQuery(this).val();e&&(t=jQuery(this).closest("figure").attr("data-path")),a.push(t)})),a};if(jQuery(".multiple-action-btn").on("click",(function(){var e=l();window[jQuery(this).attr("data-function")](e,jQuery("#field_id").val())})),jQuery(".multiple-deselect-btn").on("click",(function(){e(".selection:checkbox").removeAttr("checked"),jQuery("#multiple-selection").hide(300)})),jQuery(".multiple-select-btn").on("click",(function(){e(".selection:checkbox:visible").prop("checked",!0)})),jQuery(".multiple-delete-btn").on("click",(function(){if(0!=jQuery(".selection:checkbox:checked:visible").length){var a=jQuery(this);bootbox.confirm(a.attr("data-confirm"),jQuery("#cancel").val(),jQuery("#ok").val(),(function(a){if(1==a){var t,r,i=l(!0);t=i,r="",null!==name&&(name=h(name),e.ajax({type:"POST",url:"execute.php?action=delete_files",data:{path:t[0],paths:t,names:""}}).done((function(e){return""!=e?(bootbox.alert(e),!1):(""!=r&&window[r]("",name),!0)})));var n=jQuery("#files_number");n.text(parseInt(n.text())-i.length),jQuery(".selection:checkbox:checked:visible").each((function(){jQuery(this).closest("li").remove()})),jQuery("#multiple-selection").hide(300)}}))}})),!a.csstransforms){var s=jQuery("figure");s.on("mouseover",(function(){0==jQuery("#view").val()&&!1===jQuery("#main-item-container").hasClass("no-effect-slide")&&jQuery(this).find(".box:not(.no-effect)").animate({top:"-26px"},{queue:!1,duration:300})})),s.on("mouseout",(function(){0==jQuery("#view").val()&&jQuery(this).find(".box:not(.no-effect)").animate({top:"0px"},{queue:!1,duration:300})}))}jQuery(window).resize((function(){p(0)})),p(0),1==jQuery("#clipboard").val()?f(!0):f(!1),jQuery("li.dir, li.file").draggable({distance:20,cursor:"move",cancel:".form-check",helper:function(){var e=jQuery(this).clone();return e.css({"z-index":1e3,opacity:.5,width:jQuery(this).outerWidth()+"px","max-width":"100%"}),e.find(".box").css({"box-shadow":"none","-webkit-box-shadow":"none"}),e},start:function(e,a){jQuery(a.helper).addClass("ui-draggable-helper"),0==jQuery("#view").val()&&jQuery("#main-item-container").addClass("no-effect-slide")},stop:function(){jQuery(this).removeClass("selected"),0==jQuery("#view").val()&&jQuery("#main-item-container").removeClass("no-effect-slide")}}),jQuery("li.dir,li.back").droppable({accept:"ul.grid li",activeClass:"ui-state-highlight",hoverClass:"ui-state-hover",drop:function(a,t){var r,i,n;r=t.draggable.find("figure"),i=jQuery(this).find("figure"),r.hasClass("directory")?r.find(".rename-folder"):r.find(".rename-file"),n=r.closest("figure").attr("data-path"),r.parent().hide(100),e.ajax({type:"POST",url:"ajax_calls.php?action=copy_cut",data:{path:n,sub_action:"cut"}}).done((function(a){var t;""!=a?bootbox.alert(a):(t=void 0!==i?i.hasClass("back-directory")?i.find(".path").val():i.closest("figure").attr("data-path"):jQuery("#sub_folder").val()+jQuery("#fldr_value").val(),e.ajax({type:"POST",url:"execute.php?action=paste_clipboard",data:{path:t}}).done((function(e){""!=e?(bootbox.alert(e),r.parent().show(100)):(jQuery("#clipboard").val("0"),f(!1),r.parent().remove())})))})).error((function(){r.parent().show(100)}))}}),jQuery(document).on("keyup","#chmod_form #chmod_value",(function(){c(!0)})),jQuery(document).on("change","#chmod_form input",(function(){c(!1)})),jQuery(document).on("focusout","#chmod_form #chmod_value",(function(){var e=jQuery("#chmod_form #chmod_value");null==e.val().match(/^[0-7]{3}$/)&&(e.val(e.attr("data-def-value")),c(!0))})),i=new LazyLoad,new Clipboard(".btn")})),encodeURL=function(e){for(var a=e.split("/"),t=3;t<a.length;t++)a[t]=encodeURIComponent(a[t]);return a.join("/")},apply=function(a,t){var r=m(),i=jQuery("#callback").val(),n="",o=["ogg","mp3","wav"],l=["mp4","ogg","webm"];Array.isArray(a)||(a=Array(a));var u=v(a),c=JSON.stringify(u);if(1==u.length&&(c=u[0]),""!=t)1==jQuery("#crossdomain").val()?r.postMessage({sender:"responsivefilemanager",url:c,field_id:t},"*"):(jQuery("#"+t,r.document).val(c).trigger("change"),0==i?"function"==typeof r.responsive_filemanager_callback&&r.responsive_filemanager_callback(t):"function"==typeof r[i]&&r[i](t),j());else{for(var s=0;s<u.length;s++){var d=a[s],f=d.substr(0,d.lastIndexOf(".")),p=d.split(".").pop();p=p.toLowerCase();var y=u[s];-1<e.inArray(p,ext_img)?(jQuery("#add_time_to_img").val()&&(y=y+"?"+(new Date).getTime()),n+='<img src="'+y+'" alt="'+f+'" /> '):-1<e.inArray(p,l)?n+='<video controls source src="'+y+'" type="video/'+p+'">'+f+"</video> ":-1<e.inArray(p,o)?("mp3"==p&&(p="mpeg"),n+='<audio controls src="'+y+'" type="audio/'+p+'">'+f+"</audio> "):n+='<a href="'+y+'" title="'+f+'">'+f+"</a> "}1==jQuery("#crossdomain").val()?r.postMessage({sender:"responsivefilemanager",url:c,field_id:null,html:n},"*"):parent.tinymce.majorVersion<4?(parent.tinymce.activeEditor.execCommand("mceInsertContent",!1,n),parent.tinymce.activeEditor.windowManager.close(parent.tinymce.activeEditor.windowManager.params.mce_window_id)):(parent.tinymce.activeEditor.insertContent(n),parent.tinymce.activeEditor.windowManager.close())}},apply_link=function(e,a){var t=m(),r=jQuery("#callback").val();Array.isArray(e)||(e=Array(e));var i=v(e),n=JSON.stringify(i);1==i.length&&(n=i[0]),""!=a?1==jQuery("#crossdomain").val()?t.postMessage({sender:"responsivefilemanager",url:i[0],field_id:a},"*"):(jQuery("#"+a,t.document).val(n).trigger("change"),0==r?"function"==typeof t.responsive_filemanager_callback&&t.responsive_filemanager_callback(a):"function"==typeof t[r]&&t[r](a),j()):apply_any(i[0])},apply_img=function(e,a){var t=m(),r=jQuery("#callback").val();Array.isArray(e)||(e=Array(e));var i=v(e),n=JSON.stringify(i);if(1==i.length&&(n=i[0]),""!=a)1==jQuery("#crossdomain").val()?t.postMessage({sender:"responsivefilemanager",url:i[0],field_id:a},"*"):(jQuery("#"+a,t.document).val(n).trigger("change"),0==r?"function"==typeof t.responsive_filemanager_callback&&t.responsive_filemanager_callback(a):"function"==typeof t[r]&&t[r](a),j());else{if(jQuery("#add_time_to_img").val())var o=i[0]+"?"+(new Date).getTime();else o=i[0];apply_any(o)}},apply_video=function(e,a){var t=m(),r=jQuery("#callback").val();Array.isArray(e)||(e=Array(e));var i=v(e),n=JSON.stringify(i);1==i.length&&(n=i[0]),""!=a?1==jQuery("#crossdomain").val()?t.postMessage({sender:"responsivefilemanager",url:i[0],field_id:a},"*"):(jQuery("#"+a,t.document).val(n).trigger("change"),0==r?"function"==typeof t.responsive_filemanager_callback&&t.responsive_filemanager_callback(a):"function"==typeof t[r]&&t[r](a),j()):apply_any(i[0])},apply_none=function(e,a,t){t.parent().find("form a")[1].click(),jQuery(".tip-right").tooltip("hide")},apply_any=function(e){if(1==jQuery("#crossdomain").val())window.parent.postMessage({sender:"responsivefilemanager",url:e,field_id:null},"*");else if("ckeditor"===jQuery("#editor").val()){var a,t,r=(a=RegExp("(?:[?&]|&)CKEditorFuncNum=([^&]+)","i"),(t=window.location.search.match(a))&&1<t.length?t[1]:null);window.opener.CKEDITOR.tools.callFunction(r,e),window.close()}else window.parent.postMessage({sender:"responsivefilemanager",url:e,field_id:null},window.location.origin),parent.tinymce.activeEditor.windowManager.close()},apply_file_duplicate=function(e,a){var t=e.parent();t.after("<li class='"+t.attr("class")+"' data-name='"+t.attr("data-name")+"'>"+t.html()+"</li>");var r=t.next();apply_file_rename(r.find("figure"),a);var i=r.find(".download-form"),n="form"+(new Date).getTime();i.attr("id",n),i.find(".tip-right").first().attr("onclick","jQuery('#"+n+"').submit();")},apply_file_rename=function(e,a){e.attr("data-name",a),e.parent().attr("data-name",a),e.find("h4").text(a);var t,r=e.find("a.link"),i=(t=r.attr("data-file")).substring(t.lastIndexOf("/")+1),n=t.substring(t.lastIndexOf(".")+1);n=n?"."+n:"",r.each((function(){jQuery(this).attr("data-file",encodeURIComponent(a+n))})),e.find("img").each((function(){if(e=jQuery(this).attr("src"))jQuery(this).attr("src",e.replace(i,a+n)+"?time="+(new Date).getTime());else{var e=jQuery(this).attr("data-src");jQuery(this).attr("data-src",e.replace(i,a+n)+"?time="+(new Date).getTime())}jQuery(this).attr("alt",a+" thumbnails")}));var o=e.find("a.preview");void 0!==(t=o.attr("data-url"))&&t&&o.attr("data-url",t.replace(encodeURIComponent(i),encodeURIComponent(a+n))),e.parent().attr("data-name",a+n),e.attr("data-name",a+n),e.find(".name_download").val(a+n);var l=e.attr("data-path").replace(i,a+n);e.attr("data-path",l)},apply_folder_rename=function(e,a){e.attr("data-name",a),e.find("figure").attr("data-name",a);var t=e.find("h4").find("a").text();e.find("h4 > a").text(a);var r=e.find(".folder-link"),i=r.attr("href"),n=jQuery("#fldr_value").val(),o=i.replace("fldr="+n+encodeURIComponent(t),"fldr="+n+encodeURIComponent(a));r.each((function(){jQuery(this).attr("href",o)}));var l=e.attr("data-path"),u=l.lastIndexOf("/"),c=l.substr(0,u+1)+a;e.attr("data-path",c)},show_animation=function(){jQuery("#loading_container").css("display","block"),jQuery("#loading").css("opacity",".7")},hide_animation=function(){jQuery("#loading_container").fadeOut()}}(jQuery,Modernizr),function(){function e(e,a){a=a||{bubbles:!1,cancelable:!1,detail:void 0};var t=document.createEvent("CustomEvent");return t.initCustomEvent(e,a.bubbles,a.cancelable,a.detail),t}"function"!=typeof window.CustomEvent&&(e.prototype=window.Event.prototype,window.CustomEvent=e)}();